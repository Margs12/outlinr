/* esm.sh - topojson-client@3.1.0 */
function w(n){return n}function E(n){if(n==null)return w;var c,s,o=n.scale[0],i=n.scale[1],l=n.translate[0],m=n.translate[1];return function(p,u){u||(c=s=0);var t=2,r=p.length,e=new Array(r);for(e[0]=(c+=p[0])*o+l,e[1]=(s+=p[1])*i+m;t<r;)e[t]=p[t],++t;return e}}function k(n){var c=E(n.transform),s,o=1/0,i=o,l=-o,m=-o;function p(t){t=c(t),t[0]<o&&(o=t[0]),t[0]>l&&(l=t[0]),t[1]<i&&(i=t[1]),t[1]>m&&(m=t[1])}function u(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(u);break;case"Point":p(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(p);break}}n.arcs.forEach(function(t){for(var r=-1,e=t.length,a;++r<e;)a=c(t[r],r),a[0]<o&&(o=a[0]),a[0]>l&&(l=a[0]),a[1]<i&&(i=a[1]),a[1]>m&&(m=a[1])});for(s in n.objects)u(n.objects[s]);return[o,i,l,m]}function C(n,c){for(var s,o=n.length,i=o-c;i<--o;)s=n[i],n[i++]=n[o],n[o]=s}function q(n,c){return typeof c=="string"&&(c=n.objects[c]),c.type==="GeometryCollection"?{type:"FeatureCollection",features:c.geometries.map(function(s){return S(n,s)})}:S(n,c)}function S(n,c){var s=c.id,o=c.bbox,i=c.properties==null?{}:c.properties,l=x(n,c);return s==null&&o==null?{type:"Feature",properties:i,geometry:l}:o==null?{type:"Feature",id:s,properties:i,geometry:l}:{type:"Feature",id:s,bbox:o,properties:i,geometry:l}}function x(n,c){var s=E(n.transform),o=n.arcs;function i(r,e){e.length&&e.pop();for(var a=o[r<0?~r:r],f=0,b=a.length;f<b;++f)e.push(s(a[f],f));r<0&&C(e,b)}function l(r){return s(r)}function m(r){for(var e=[],a=0,f=r.length;a<f;++a)i(r[a],e);return e.length<2&&e.push(e[0]),e}function p(r){for(var e=m(r);e.length<4;)e.push(e[0]);return e}function u(r){return r.map(p)}function t(r){var e=r.type,a;switch(e){case"GeometryCollection":return{type:e,geometries:r.geometries.map(t)};case"Point":a=l(r.coordinates);break;case"MultiPoint":a=r.coordinates.map(l);break;case"LineString":a=m(r.arcs);break;case"MultiLineString":a=r.arcs.map(m);break;case"Polygon":a=u(r.arcs);break;case"MultiPolygon":a=r.arcs.map(u);break;default:return null}return{type:e,coordinates:a}}return t(c)}function P(n,c){var s={},o={},i={},l=[],m=-1;c.forEach(function(t,r){var e=n.arcs[t<0?~t:t],a;e.length<3&&!e[1][0]&&!e[1][1]&&(a=c[++m],c[m]=t,c[r]=a)}),c.forEach(function(t){var r=p(t),e=r[0],a=r[1],f,b;if(f=i[e])if(delete i[f.end],f.push(t),f.end=a,b=o[a]){delete o[b.start];var h=b===f?f:f.concat(b);o[h.start=f.start]=i[h.end=b.end]=h}else o[f.start]=i[f.end]=f;else if(f=o[a])if(delete o[f.start],f.unshift(t),f.start=e,b=i[e]){delete i[b.end];var d=b===f?f:b.concat(f);o[d.start=b.start]=i[d.end=f.end]=d}else o[f.start]=i[f.end]=f;else f=[t],o[f.start=e]=i[f.end=a]=f});function p(t){var r=n.arcs[t<0?~t:t],e=r[0],a;return n.transform?(a=[0,0],r.forEach(function(f){a[0]+=f[0],a[1]+=f[1]})):a=r[r.length-1],t<0?[a,e]:[e,a]}function u(t,r){for(var e in t){var a=t[e];delete r[a.start],delete a.start,delete a.end,a.forEach(function(f){s[f<0?~f:f]=1}),l.push(a)}}return u(i,o),u(o,i),c.forEach(function(t){s[t<0?~t:t]||l.push([t])}),l}function z(n){return x(n,L.apply(this,arguments))}function L(n,c,s){var o,i,l;if(arguments.length>1)o=_(n,c,s);else for(i=0,o=new Array(l=n.arcs.length);i<l;++i)o[i]=i;return{type:"MultiLineString",arcs:P(n,o)}}function _(n,c,s){var o=[],i=[],l;function m(e){var a=e<0?~e:e;(i[a]||(i[a]=[])).push({i:e,g:l})}function p(e){e.forEach(m)}function u(e){e.forEach(p)}function t(e){e.forEach(u)}function r(e){switch(l=e,e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"LineString":p(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":t(e.arcs);break}}return r(c),i.forEach(s==null?function(e){o.push(e[0].i)}:function(e){s(e[0].g,e[e.length-1].g)&&o.push(e[0].i)}),o}function B(n){for(var c=-1,s=n.length,o,i=n[s-1],l=0;++c<s;)o=i,i=n[c],l+=o[0]*i[1]-o[1]*i[0];return Math.abs(l)}function F(n){return x(n,j.apply(this,arguments))}function j(n,c){var s={},o=[],i=[];c.forEach(l);function l(u){switch(u.type){case"GeometryCollection":u.geometries.forEach(l);break;case"Polygon":m(u.arcs);break;case"MultiPolygon":u.arcs.forEach(m);break}}function m(u){u.forEach(function(t){t.forEach(function(r){(s[r=r<0?~r:r]||(s[r]=[])).push(u)})}),o.push(u)}function p(u){return B(x(n,{type:"Polygon",arcs:[u]}).coordinates[0])}return o.forEach(function(u){if(!u._){var t=[],r=[u];for(u._=1,i.push(t);u=r.pop();)t.push(u),u.forEach(function(e){e.forEach(function(a){s[a<0?~a:a].forEach(function(f){f._||(f._=1,r.push(f))})})})}}),o.forEach(function(u){delete u._}),{type:"MultiPolygon",arcs:i.map(function(u){var t=[],r;if(u.forEach(function(h){h.forEach(function(d){d.forEach(function(y){s[y<0?~y:y].length<2&&t.push(y)})})}),t=P(n,t),(r=t.length)>1)for(var e=1,a=p(t[0]),f,b;e<r;++e)(f=p(t[e]))>a&&(b=t[0],t[0]=t[e],t[e]=b,a=f);return t}).filter(function(u){return u.length>0})}}function A(n,c){for(var s=0,o=n.length;s<o;){var i=s+o>>>1;n[i]<c?s=i+1:o=i}return s}function I(n){var c={},s=n.map(function(){return[]});function o(h,d){h.forEach(function(y){y<0&&(y=~y);var g=c[y];g?g.push(d):c[y]=[d]})}function i(h,d){h.forEach(function(y){o(y,d)})}function l(h,d){h.type==="GeometryCollection"?h.geometries.forEach(function(y){l(y,d)}):h.type in m&&m[h.type](h.arcs,d)}var m={LineString:o,MultiLineString:i,Polygon:i,MultiPolygon:function(h,d){h.forEach(function(y){i(y,d)})}};n.forEach(l);for(var p in c)for(var u=c[p],t=u.length,r=0;r<t;++r)for(var e=r+1;e<t;++e){var a=u[r],f=u[e],b;(b=s[a])[p=A(b,f)]!==f&&b.splice(p,0,f),(b=s[f])[p=A(b,a)]!==a&&b.splice(p,0,a)}return s}function G(n){if(n==null)return w;var c,s,o=n.scale[0],i=n.scale[1],l=n.translate[0],m=n.translate[1];return function(p,u){u||(c=s=0);var t=2,r=p.length,e=new Array(r),a=Math.round((p[0]-l)/o),f=Math.round((p[1]-m)/i);for(e[0]=a-c,c=a,e[1]=f-s,s=f;t<r;)e[t]=p[t],++t;return e}}function T(n,c){if(n.transform)throw new Error("already quantized");if(!c||!c.scale){if(!((m=Math.floor(c))>=2))throw new Error("n must be \u22652");u=n.bbox||k(n);var s=u[0],o=u[1],i=u[2],l=u[3],m;c={scale:[i-s?(i-s)/(m-1):1,l-o?(l-o)/(m-1):1],translate:[s,o]}}else u=n.bbox;var p=G(c),u,t,r=n.objects,e={};function a(h){return p(h)}function f(h){var d;switch(h.type){case"GeometryCollection":d={type:"GeometryCollection",geometries:h.geometries.map(f)};break;case"Point":d={type:"Point",coordinates:a(h.coordinates)};break;case"MultiPoint":d={type:"MultiPoint",coordinates:h.coordinates.map(a)};break;default:return h}return h.id!=null&&(d.id=h.id),h.bbox!=null&&(d.bbox=h.bbox),h.properties!=null&&(d.properties=h.properties),d}function b(h){var d=0,y=1,g=h.length,M,v=new Array(g);for(v[0]=p(h[0],0);++d<g;)((M=p(h[d],d))[0]||M[1])&&(v[y++]=M);return y===1&&(v[y++]=[0,0]),v.length=y,v}for(t in r)e[t]=f(r[t]);return{type:"Topology",bbox:u,transform:c,objects:e,arcs:n.arcs.map(b)}}export{k as bbox,q as feature,F as merge,j as mergeArcs,z as mesh,L as meshArcs,I as neighbors,T as quantize,E as transform,G as untransform};
//# sourceMappingURL=topojson-client.mjs.map